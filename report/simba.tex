\section{The \simba{} Simulation Suite}
\label{sec:simba}

This work uses the \simba{} simulation suite \citep{Dave2019}, which inherits a
large amount of physics from \mufasa{} \citep{Dave2016}. \simba{} uses a
variant of the GIZMO code \citep{Hopkins2015}, with the Meshless-Finite-Mass
(MFM) hydrodynamics solver using a Wentland C2 kernel with 64 neighbours. The
gravitational forces are solved using the Tree-PM method as described in
\citet{Springel2005b} for Gadget-2, of which GIZMO is a descendent. In the $50 \hmpc{}$, $512^3$ particle box used here, the mass resolution for the gas elements is $1.7\times10^7h^{-1}$ M$_\odot$, and for the dark matter is $7\times10^7h^{-1}$ M$_\odot$. The cosmology used in \simba{} is consistent with results from
\citet{PlanckCollaboration2016}, with $\Omega_\Lambda = 0.7$, $\Omega_{\rm m} =
0.3$, $\Omega_{\rm b} = 0.048$, $H_0 = 68$ km s$^{-1}$, $\sigma_8=0.82$, and
$n_s=0.97$.

On top of this base code, the \simba{} sub-grid model is implemented. This
model is fully described in \citet{Dave2019}, but it is summarised here.
Radiative cooling and photoionisation are included from Grackle-3.1
\citep{Smith2016}. Stellar feedback is modelled using decoupled two-phase winds
that have 30\% of their ejected particles set at a temperature given by the
supernova energy minus the kinetic energy of the wind. The mass
loading factor of these winds scales with stellar mass using scalings from
\citet{AnglesAlcazar2017}, obtained from particle tracking in the FIRE zoom-in simulations.

Black hole growth and feedback is included in \simba{}, using the torque-limited
accretion model from \citet{AnglesAlcazar2017b} for cold gas and \citet{Bondi1952}
accretion for the hot gas. The AGN feedback model includes both kinetic
(winds) and energetic (X-ray) feedback. At high Eddington ratios or low black holes mass ($M_{\rm BH} < 10^{7.5}$
M$_\odot$), the
radiative-mode winds are ejected at interstellar medium (ISM) temperature at low velocity $\sim 10^3 \kms{}$. At low Eddington ratios and high black holes mass, the jet-mode winds are ejected at velocities approaching $\sim 10^4\kms{}$. We refer the interested reader to the full description of this
feedback model in \citet{Dave2019}.

In addition to the fiducial model, we also use two comparison models. The first, described as \nojet{}, includes all of the \simba{} physics, has the high-energy black hole jet-mode winds disabled.  All other star formation and AGN feedback is included.  The second, described as non-
radiative, uses the same initial conditions as the fiducial model but only
includes gravitational dynamics and hydrodynamics, i.e. without a sub-grid
model. This latter simulation was performed with the {\sc Swift} simulation
code \citep{Schaller2016} using a Density-Entropy Smoothed Particle
Hydrodynamics (SPH) solver as it performs orders of magnitude faster than the
original GIZMO code \citep{Borrow2018}. The use of this hydrodynamics model,
over the MFM solver, will have a negligible effect on the quantities of
interest in this paper (i.e. positions of particles at $z=0$), as it has been
shown that such a solver produces halos of the same baryonic mass when ran in
non-radiative mode \citep[see e.g.][]{Sembolini2016}.


\subsection{Defining halos}

Halos in the following discussion are defined using the Amiga Halo Finder
\citep[AHF, ][]{Gill2004, Knollmann2009} version 1.0-100. This spherical
overdensity finder determines the halo centers by using a nested grid, and
then fits parameters based on the Navarro-Frenk-White \citep[NFW,
][]{Navarro1995} profile. Here we define the virial radius, $R_{vir}$, as the
spherical overdensity radius retrieved from AHF consistent with
\citet{Lacey1994}. Substructure search was turned off, such that the code
only returned main halos.

\subsection{Defining lagrangian regions}

Many methods exist for defining lagrangian regions, but these are mostly used for
zoom-in simulations and some, for example using a cube of particles around a given
halo, could be seen as being non-lagrangian and over-conservative. In the below
discussion the lagrangian regions are defined in the initial conditions in the
following way:
\begin{enumerate}
	\item Find all halos at $z=0$.

    \item For each halo, ID match the particles contained within it with those
		  in the initial conditions. This defines the initial lagrangian region
		  based on the dark matter.

	\item In some cases, discussed below, fill in the holes in this lagrangian
	      region by using a nearest-neighbour search.

	\item For every gas particle in the initial conditions, find the nearest dark
	      matter neighbour. This gas particle is assigned to the same lagrangian
	      region as that dark matter particle.
\end{enumerate}
This allows the definition of the lagrangian region to also extend to the gas
that should be gravitationally bound by that halo at $z=0$.